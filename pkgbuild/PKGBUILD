# Maintainer: Leonardo Berbert <leo4berbert@gmail.com>

pkgname=comm-wallpapers-hyprland
pkgdesc="Custom wallpapers for Hyprland in BigCommunity distribution"
pkgver=$(date +%y.%m.%d)
pkgrel=$(date +%H%M)
arch=('any')
license=('GPL')
url="https://github.com/communitybig/${pkgname}"
source=("git+${url}.git")
md5sums=('SKIP')

# Automatically detect and use the correct install file
if [ -e "${pkgname}.install" ]; then
    install=${pkgname}.install
elif [ -e "pkgbuild.install" ]; then
    install=pkgbuild.install
fi

prepare() {
    cd "${srcdir}/${pkgname}"
    # No preparation steps needed
}

build() {
    cd "${srcdir}/${pkgname}"
    # No build steps needed
}

package() {
    cd "${srcdir}/${pkgname}"

    # Create target directories
    install -dm755 "${pkgdir}/usr/share/hypr"
    install -dm755 "${pkgdir}/usr/share/backgrounds/community"

    # Copy all wallpapers to /usr/share/backgrounds/community
    cp -af usr/share/backgrounds/community/* "${pkgdir}/usr/share/backgrounds/community/"

    # Remove existing wall*.png files before copying
    for i in {0..2}; do
        if [ -f "${pkgdir}/usr/share/hypr/wall${i}.png" ]; then
            rm -f "${pkgdir}/usr/share/hypr/wall${i}.png"
        fi
        cp -f usr/share/backgrounds/community/animal-hpr-001.jpg "${pkgdir}/usr/share/hypr/wall${i}.png"
    done

    # Install license file if present
    if [ -f "LICENSE" ]; then
        install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
    fi

    # Install documentation if present
    if [ -f "README.md" ]; then
        install -Dm644 README.md "${pkgdir}/usr/share/doc/${pkgname}/README.md"
    fi
}
